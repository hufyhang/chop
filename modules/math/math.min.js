$ch.define("math",function(){"use strict";$$CHOP.math={},Math.constructor.prototype.cot=function(a){return 1/Math.tan(a)},Math.constructor.prototype.sqr=function(a,t){return Math.exp(1/t*Math.log(a))};var generateEval=function(a){var t=a.match(/sin\(.*?\)/g);null!==t&&$$CHOP.each(t,function(t){var e=t.replace(/sin\(/g,"Math.sin(");a=a.replace(t,e)});var e=a.match(/cos\(.*?\)/g);null!==e&&$$CHOP.each(e,function(t){var e=t.replace(/cos\(/g,"Math.cos(");a=a.replace(t,e)});var r=a.match(/tan\(.*?\)/g);null!==r&&$$CHOP.each(r,function(t){var e=t.replace(/tan\(/g,"Math.tan(");a=a.replace(t,e)});var c=a.match(/cot\(.*?\)/g);null!==c&&$$CHOP.each(c,function(t){var e=t.replace(/cot\(/g,"Math.cot(");a=a.replace(t,e)});var l=a.match(/sqrt\(.*?\)/g);null!==l&&$$CHOP.each(l,function(t){var e=t.replace(/sqrt\(/g,"Math.sqrt(");a=a.replace(t,e)});var n=a.match(/sqr\(.*?\)/g);null!==n&&$$CHOP.each(n,function(t){var e=t.replace(/sqr\(/g,"Math.sqr(");a=a.replace(t,e)});var o=a.match(/exp\(.*?\)/g);null!==o&&$$CHOP.each(o,function(t){var e=t.replace(/exp\(/g,"Math.exp(");a=a.replace(t,e)});var h=a.match(/log\(.*?\)/g);null!==h&&$$CHOP.each(h,function(t){var e=t.replace(/log\(/g,"Math.log(");a=a.replace(t,e)});var u=a.match(/pow\(.*?\)/g);return null!==u&&$$CHOP.each(u,function(t){var e=t.replace(/pow\(/g,"Math.pow(");a=a.replace(t,e)}),u=a.match(/[-.\w\d()]+\ *\^\ *[-.\w\d()]+/g),null!==u&&$$CHOP.each(u,function(t){var e=t.replace(/\^/g,",");e="Math.pow("+e+")",a=a.replace(t,e)}),a};$$CHOP.math={eval:function(calc){if(1!==arguments.length)throw new Error("$ch.math.eval requires a calculation parameter.");if("string"!=typeof calc)return!1;calc=generateEval(calc);var value=eval(calc),valueStr=value+"",factor=2,prev="",startMatch=!1,isHuge=!1;-1!==valueStr.indexOf("e")&&(isHuge=!0);for(var index=valueStr.length-2;-1!==index;--index){var digit=valueStr[index];if(digit===prev)startMatch===!1&&(startMatch=!0),++factor;else{var isOkSmall=index<valueStr.length-3&&startMatch===!1&&isHuge===!1;if(isOkSmall){factor=-1;break}if(startMatch===!0)break}prev=digit}var result=value;return-1!==factor&&(factor=Math.pow(10,factor),result=Math.round(value*factor)/factor),result}}});