$ch.define("math",function(){"use strict";$$CHOP.math={},Math.constructor.prototype.cot=function(a){return 1/Math.tan(a)},Math.constructor.prototype.sqr=function(a,b){return Math.exp(1/b*Math.log(a))};var generateEval=function(a){var b=a.match(/sin\(.*?\)/g);null!==b&&$$CHOP.each(b,function(b){var c=b.replace(/sin\(/g,"Math.sin(");a=a.replace(b,c)});var c=a.match(/cos\(.*?\)/g);null!==c&&$$CHOP.each(c,function(b){var c=b.replace(/cos\(/g,"Math.cos(");a=a.replace(b,c)});var d=a.match(/tan\(.*?\)/g);null!==d&&$$CHOP.each(d,function(b){var c=b.replace(/tan\(/g,"Math.tan(");a=a.replace(b,c)});var e=a.match(/cot\(.*?\)/g);null!==e&&$$CHOP.each(e,function(b){var c=b.replace(/cot\(/g,"Math.cot(");a=a.replace(b,c)});var f=a.match(/sqrt\(.*?\)/g);null!==f&&$$CHOP.each(f,function(b){var c=b.replace(/sqrt\(/g,"Math.sqrt(");a=a.replace(b,c)});var g=a.match(/sqr\(.*?\)/g);null!==g&&$$CHOP.each(g,function(b){var c=b.replace(/sqr\(/g,"Math.sqr(");a=a.replace(b,c)});var h=a.match(/exp\(.*?\)/g);null!==h&&$$CHOP.each(h,function(b){var c=b.replace(/exp\(/g,"Math.exp(");a=a.replace(b,c)});var i=a.match(/log\(.*?\)/g);null!==i&&$$CHOP.each(i,function(b){var c=b.replace(/log\(/g,"Math.log(");a=a.replace(b,c)});var j=a.match(/pow\(.*?\)/g);return null!==j&&$$CHOP.each(j,function(b){var c=b.replace(/pow\(/g,"Math.pow(");a=a.replace(b,c)}),j=a.match(/[-.\w\d()]+\ *\^\ *[-.\w\d()]+/g),null!==j&&$$CHOP.each(j,function(b){var c=b.replace(/\^/g,",");c="Math.pow("+c+")",a=a.replace(b,c)}),a};$$CHOP.math={eval:function(calc){if(1!==arguments.length)throw new Error("$ch.math.eval requires a calculation parameter.");if("string"!=typeof calc)return!1;calc=generateEval(calc);var value=eval(calc),valueStr=value+"",factor=2,prev="",startMatch=!1,isHuge=!1;-1!==valueStr.indexOf("e")&&(isHuge=!0);for(var index=valueStr.length-2;-1!==index;--index){var digit=valueStr[index];if(digit===prev)startMatch===!1&&(startMatch=!0),++factor;else{var isOkSmall=index<valueStr.length-3&&startMatch===!1&&isHuge===!1;if(isOkSmall){factor=-1;break}if(startMatch===!0)break}prev=digit}var result=value;return-1!==factor&&(factor=Math.pow(10,factor),result=Math.round(value*factor)/factor),result}}});